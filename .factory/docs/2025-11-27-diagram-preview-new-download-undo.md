Ниже конкретный план доработок, с учётом того, что Download/Undo больше не нужны.

**1. Модель состояния**
- В `app.js` завести `diagramHistory` (массив `{ id, label, structuralCode, finalCode, createdAt, conversationLog, docsDebug }`) и `activeDiagramIndex`.
- Глобальные `conversationLog` и `lastDocsDebug` заменить на поля внутри активного элемента истории; состояние LLM‑диалога и Docs / Context7 всегда берём из выбранной диаграммы.
- При успешной генерации: сохранять в историю и структуру (результат первого шага), и финальный оформленный код (результат второго шага) в одну запись.

**2. Поведение кнопок Generate / New**
- `Generate` всегда добавляет НОВУЮ запись в `diagramHistory` на основе текущего Prompt (и текущей диаграммы, если обновляем) и делает её активной; старые диаграммы остаются во вкладках.
- `New` полностью очищает историю и состояние UI: `diagramHistory = []`, `activeDiagramIndex = -1`, очищаются Diagram Preview, LLM Conversation, Docs / Context7, Model Reasoning, статус; Prompt можно либо оставлять, либо по умолчанию тоже чистить.
- После `New` первая успешная генерация создаёт первую запись истории и активирует её.

**3. Diagram Preview: вкладки и выбор структуры/стиля**
- Над блоком "Diagram Preview" добавить горизонтальную панель вкладок: по одной на каждый элемент `diagramHistory` (например, `D1`, `D2` или из `label`), с подсветкой активной.
- При выборе вкладки: обновлять `activeDiagramIndex`, рендерить выбранную диаграмму в предпросмотр, подгружать связанный `conversationLog` и `docsDebug` в соответствующие окна, обновлять Model Reasoning.
- Внутри активной вкладки добавить простой переключатель "Structure / Styled": при `Structure` показывать `structuralCode`, при `Styled` — `finalCode` (по умолчанию `Styled`).

**4. UI‑чистка: убрать Download/Undo**
- Из разметки правой карточки убрать кнопку Download и весь связанный JS‑код (генерация .mmd, обновление состояния кнопки).
- Из левой карточки убрать Undo‑кнопку и логику отката; роль "отката" фактически берут на себя вкладки: можно просто переключиться на предыдущую диаграмму.

После твоего подтверждения реализую это в `public/index.html` и `public/app.js`, не трогая бэкенд.