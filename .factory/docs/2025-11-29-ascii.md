Чтобы устранить ошибки из-за символов вроде ﬂ/¶/ß, сделаем небольшой постпроцессинг на клиенте:

1. Добавить helper `sanitizeMermaidCode(code)` в `public/app.js`, который:
   • заменяет любые символы вне диапазона printable ASCII (32-126) на близкие аналоги либо пробел;
   • дополнительно нормализует кавычки к прямым (" / ').
2. После каждого вызова LLM (structure/style/fix) перед валидацией прогонять код через санитайзер (и сохранять уже очищенную версию в `stage.code`/`iteration.activeCode`).
3. В логах/модалках показывать очищенный код, но если нужно, можно сохранить raw версию в `stage.assistantRaw` (уже есть).

После подтверждения – реализуем helper, внедрим в поток structure/style/fix и прогонем eslint.